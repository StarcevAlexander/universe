name: Test Deployment

on: workflow_dispatch

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: Test deployment
        run: |
          mkdir -p ~/.ssh
          echo "${{ secrets.VM_SSH_KEY }}" > ~/.ssh/key
          chmod 600 ~/.ssh/key
          
          # –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
          cat > index.html << 'EOF'
          <!DOCTYPE html>
          <html>
          <head>
              <title>Deployment Success!</title>
              <style>
                  body { 
                      font-family: Arial, sans-serif; 
                      margin: 40px;
                      background: linear-gradient(135deg, #667eea, #764ba2);
                      color: white;
                      text-align: center;
                  }
                  .container {
                      background: rgba(255,255,255,0.1);
                      padding: 40px;
                      border-radius: 10px;
                      backdrop-filter: blur(10px);
                      display: inline-block;
                  }
              </style>
          </head>
          <body>
              <div class="container">
                  <h1>üöÄ Success!</h1>
                  <p>GitHub Actions deployed this file</p>
                  <p>Time: $(date)</p>
              </div>
          </body>
          </html>
          EOF
          
          # –ö–æ–ø–∏—Ä—É–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä
          scp -i ~/.ssh/key -o StrictHostKeyChecking=no index.html deploy@${{ secrets.VM_HOST }}:/var/www/your-app/
          
          # –ü—Ä–æ–≤–µ—Ä—è–µ–º
          ssh -i ~/.ssh/key deploy@${{ secrets.VM_HOST }} "ls -la /var/www/your-app/"
          
          echo "‚úÖ Deployment successful! Check http://95.163.229.106/"